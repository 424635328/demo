name: 'CI: Pull Request Checks'

on:
  pull_request:
    branches:
      - main # ä»…å½“ PR ç›®æ ‡åˆ†æ”¯æ˜¯ main æ—¶è§¦å‘

jobs:
  # ä»»åŠ¡ä¸€ï¼šè¿è¡Œå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œ Lint
  checks: # å¯ä»¥å°† job åç§°æ”¹ä¸ºæ›´é€šç”¨çš„ 'checks'
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: Install dependencies
        run: npm install

      - name: Run lint
        run: npm run lint # ğŸ‘ˆ æ·»åŠ è¿™ä¸ªæ­¥éª¤æ¥è¿è¡Œ Lint
        continue-on-error: true
        # å¦‚æœ lint å¤±è´¥ä¸åº”è¯¥é˜»æ–­åç»­æ­¥éª¤ï¼Œå¯ä»¥æ·»åŠ  continue-on-error: true
        # ä½†é€šå¸¸æˆ‘ä»¬å¸Œæœ› lint é”™è¯¯ä¹Ÿèƒ½å¤±è´¥ CI

      - name: Run tests
        run: npm test
        continue-on-error: true
        # åŒæ ·ï¼Œå¦‚æœæµ‹è¯•å¤±è´¥ä¸åº”è¯¥é˜»æ–­åç»­æ­¥éª¤ï¼Œå¯ä»¥æ·»åŠ  continue-on-error: true

  # ä»»åŠ¡äºŒï¼šè¿è¡Œæ„å»º (å¦‚æœä½ çš„é¡¹ç›®éœ€è¦)
  build:
    runs-on: ubuntu-latest
    needs: checks # ç¡®ä¿åœ¨æ‰€æœ‰æ£€æŸ¥é€šè¿‡åæ‰è¿è¡Œæ„å»º
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: Install dependencies
        run: npm install

      - name: Build project
        run: npm run build
        